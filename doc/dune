(rule
 (targets sphinx_build)
 (deps
  ; We could use finer dependencies here so the build is faster:
  ;
  ; - vo files: generated by sphinx after parsing the doc, promoted,
  ; - Static files:
  ;   + %{bin:coqdoc} etc...
  ;   + config/coq_config.py
  ;   + tools/coqdoc/coqdoc.css
  (package coq)
  (source_tree sphinx)
  (source_tree tools))
 (action (run sphinx-build -j4 -b html -d sphinx_build/doctrees sphinx sphinx_build/html)))

(alias
 (name refman-html)
 (deps sphinx_build))

; The install target still needs more work.
; (install
;  (section doc)
;  (package coq-refman)
;  (files sphinx_build))
